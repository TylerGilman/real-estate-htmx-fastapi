{# templates/admin/properties/image_gallery.html #}
<div class="image-gallery" id="property-images">
    <div class="current-images">
        {% for image in images %}
        <div class="image-container" id="image-{{ image.image_id }}">
            <img src="/static/{{ image.file_path }}" alt="Property image">
            <div class="image-actions">
                <button class="set-primary-btn {% if image.is_primary %}active{% endif %}"
                        hx-put="/admin/properties/images/{{ image.image_id }}/primary"
                        hx-target="#property-images">
                    {% if image.is_primary %}
                    Primary Image
                    {% else %}
                    Set as Primary
                    {% endif %}
                </button>
                <button class="delete-btn"
                        hx-delete="/admin/properties/images/{{ image.image_id }}"
                        hx-confirm="Are you sure you want to delete this image?"
                        hx-target="#property-images">
                    Delete
                </button>
            </div>
        </div>
        {% endfor %}
    </div>
    
    <div class="upload-section">
        <form hx-post="/admin/properties/{{ property_id }}/images"
              hx-encoding="multipart/form-data"
              hx-target="#property-images"
              class="upload-form">
            <label class="file-upload-label">
                <span>Add Images</span>
                <input type="file"
                       name="files"
                       multiple
                       accept=".jpg,.jpeg,.png,.webp"
                       class="hidden"
                       onchange="this.form.submit()">
            </label>
            <div class="upload-help">
                Max 5MB per image. JPG, PNG or WebP only.
            </div>
        </form>
    </div>
</div>

<style>
.image-gallery {
    margin-top: 2rem;
}

.current-images {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 1rem;
    margin-bottom: 1rem;
}

.image-container {
    position: relative;
    border-radius: 0.5rem;
    overflow: hidden;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.image-container img {
    width: 100%;
    height: 150px;
    object-fit: cover;
}

.image-actions {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: rgba(0, 0, 0, 0.7);
    padding: 0.5rem;
    display: flex;
    gap: 0.5rem;
    opacity: 0;
    transition: opacity 0.2s;
}

.image-container:hover .image-actions {
    opacity: 1;
}

.set-primary-btn,
.delete-btn {
    padding: 0.25rem 0.5rem;
    border-radius: 0.25rem;
    font-size: 0.875rem;
    border: none;
    cursor: pointer;
}

.set-primary-btn {
    background: var(--swedish-blue);
    color: white;
}

.set-primary-btn.active {
    background: var(--swedish-navy);
}

.delete-btn {
    background: #ef4444;
    color: white;
}

.upload-section {
    margin-top: 2rem;
    padding: 2rem;
    border: 2px dashed var(--swedish-gray);
    border-radius: 0.5rem;
    text-align: center;
}

.file-upload-label {
    display: inline-block;
    padding: 0.75rem 1.5rem;
    background: var(--swedish-accent);
    color: var(--swedish-navy);
    border-radius: 0.5rem;
    cursor: pointer;
    transition: background-color 0.2s;
}

.file-upload-label:hover {
    background: var(--swedish-gray);
}

.upload-help {
    margin-top: 0.5rem;
    font-size: 0.875rem;
    color: var(--swedish-text);
    opacity: 0.8;
}

.hidden {
    display: none;
}
</style>
