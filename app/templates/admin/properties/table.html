{# templates/admin/properties/table.html #}
<div class="stats-grid">
    <div class="stat-card">
        <h3>Total Properties</h3>
        <p class="stat-value">{{ total_properties|default(0) }}</p>
    </div>
    <div class="stat-card">
        <h3>Active Listings</h3>
        <p class="stat-value">{{ active_listings|default(0) }}</p>
    </div>
    <div class="stat-card">
        <h3>Total Value</h3>
        <p class="stat-value">
            {% if total_value and total_value > 0 %}
                ${{ "{:,.2f}".format(total_value / 1_000_000) }}M
            {% else %}
                $0
            {% endif %}
        </p>
    </div>
    <div class="stat-card">
        <h3>Average Price</h3>
        <p class="stat-value">
            {% if avg_price and avg_price > 0 %}
                ${{ "{:,.0f}".format(avg_price / 1_000) }}K
            {% else %}
                $0
            {% endif %}
        </p>
    </div>
</div>

<div class="admin-table">
    <div class="table-responsive">
        <div class="table-row table-header">
            <div class="table-cell">Property</div>
            <div class="table-cell">Details</div>
            <div class="table-cell">Status & Price</div>
            <div class="table-cell">Location</div>
            <div class="table-cell">Actions</div>
        </div>

        {% for property in properties %}
        <div class="table-row">
            <div class="table-cell">
                <div class="property-title">{{ property.title }}</div>
                <div class="property-type text-muted">
                    {{ property.property_type }}
                    {% if property.property_type == 'Residential' and property.residential %}
                    â€¢ {{ property.residential.bedrooms }} bed, {{ property.residential.bathrooms }} bath
                    {% endif %}
                </div>
            </div>
            <div class="table-cell">
                <div>
                    <span class="text-muted">Area:</span> 
                    {{ "{:,.0f}".format(property.square_feet) }} sqft
                </div>
                <div>
                    <span class="text-muted">Built:</span>
                    {{ property.year_built }}
                </div>
            </div>
            <div class="table-cell">
                <div class="status-badge {{ property.status.lower().replace(' ', '-') }}">
                    {{ property.status }}
                </div>
                <div class="property-price">
                    ${{ "{:,.0f}".format(property.price) }}
                </div>
            </div>
            <div class="table-cell">
                <div>{{ property.street_address }}</div>
                <div class="text-muted">{{ property.city }}, {{ property.state }} {{ property.zip_code }}</div>
            </div>
            <div class="table-cell actions">
                <button class="action-button edit"
                        hx-get="/admin/properties/{{ property.property_id }}/edit"
                        hx-target="#property-form-container">Edit</button>
                <button class="action-button delete"
                        hx-delete="/admin/properties/{{ property.property_id }}"
                        hx-confirm="Are you sure you want to delete this property?"
                        hx-target="closest .table-row"
                        hx-swap="outerHTML">Delete</button>
            </div>
        </div>
        {% else %}
        <div class="table-row">
            <div class="table-cell empty-state" colspan="5">
                <p>No properties found</p>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
