<div id="property-form-container" class="form-container">
    <div class="admin-header">
        <h2>Edit Property</h2>
        <button type="button" class="close-button" onclick="cancelForm()" aria-label="Close form">Ã—</button>
    </div>
    
    <form hx-put="/admin/properties/{{ property.property_id }}"
          class="property-form"
          hx-target="#properties-list"
          hx-push-url="false"
          hx-swap="innerHTML">
        
        <!-- Agent and Client Assignment -->
        <div class="form-section">
            <div class="form-header">Client & Agent Assignment</div>
            <div class="form-grid">
                <div class="form-group">
                    <label class="form-label">Select Agent</label>
                    <select name="agent_id" required class="form-select">
                        <option value="">Choose an agent</option>
                        {% for agent in agents %}
                        <option value="{{ agent.agent_id }}" 
                                {% if property.agent_id == agent.agent_id %}selected{% endif %}>
                            {{ agent.agent_name }} ({{ agent.agent_phone }})
                        </option>
                        {% endfor %}
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">Select Client (Seller)</label>
                    <select name="client_id" required class="form-select">
                        <option value="">Choose a client</option>
                        {% for client in clients %}
                        <option value="{{ client.client_id }}"
                                {% if property.client_id == client.client_id %}selected{% endif %}>
                            {{ client.client_name }} ({{ client.client_phone }})
                        </option>
                        {% endfor %}
                    </select>
                </div>
            </div>
        </div>

        <!-- Basic Property Information -->
        <div class="form-section">
            <div class="form-header">Property Details</div>
            <div class="form-grid">
                <div class="form-group">
                    <label class="form-label">Tax ID</label>
                    <input type="text" 
                           name="tax_id" 
                           value="{{ property.tax_id }}"
                           required 
                           class="form-input">
                </div>

                <div class="form-group">
                    <label class="form-label">Address</label>
                    <input type="text" 
                           name="property_address" 
                           value="{{ property.property_address }}"
                           required 
                           class="form-input">
                </div>

                <div class="form-group">
                    <label class="form-label">Status</label>
                    <select name="status" required class="form-select">
                        {% for status in ['For Sale', 'For Lease', 'Sold', 'Leased'] %}
                            <option value="{{ status }}" 
                                    {% if property.status == status %}selected{% endif %}>
                                {{ status }}
                            </option>
                        {% endfor %}
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">Price</label>
                    <input type="number" 
                           name="price" 
                           value="{{ property.price }}"
                           required 
                           min="0" 
                           step="0.01"
                           class="form-input">
                </div>

                <div class="form-group">
                    <label class="form-label">Year Built</label>
                    <input type="number" 
                           name="year_built" 
                           value="{{ property.year_built }}"
                           class="form-input">
                </div>

                <div class="form-group">
                    <label class="form-label">Property Type</label>
                    <select name="property_type" 
                            id="propertyType" 
                            required 
                            onchange="togglePropertyTypeFields()"
                            class="form-select">
                        <option value="">Select Property Type</option>
                        <option value="RESIDENTIAL" {% if property.property_type == 'RESIDENTIAL' %}selected{% endif %}>
                            Residential
                        </option>
                        <option value="COMMERCIAL" {% if property.property_type == 'COMMERCIAL' %}selected{% endif %}>
                            Commercial
                        </option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">Lot Size (sq ft)</label>
                    <input type="number" 
                           name="lot_size" 
                           value="{{ property.lot_size }}"
                           min="0"
                           class="form-input">
                </div>

                <div class="form-group">
                    <label class="form-label">Property Tax</label>
                    <input type="number" 
                           name="property_tax" 
                           value="{{ property.property_tax }}"
                           min="0"
                           step="0.01"
                           class="form-input">
                </div>
            </div>
        </div>

<style>
.image-upload-container {
    margin-top: 1rem;
}

.current-images {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 1rem;
    margin-bottom: 1rem;
}

.image-preview {
    position: relative;
    border-radius: 0.5rem;
    overflow: hidden;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.image-preview img {
    width: 100%;
    height: 150px;
    object-fit: cover;
}

.image-actions {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: rgba(0, 0, 0, 0.7);
    padding: 0.5rem;
    display: flex;
    gap: 0.5rem;
}

.set-primary-btn,
.delete-btn {
    padding: 0.25rem 0.5rem;
    border-radius: 0.25rem;
    font-size: 0.875rem;
    cursor: pointer;
}

.set-primary-btn {
    background: var(--swedish-blue);
    color: white;
    border: none;
}

.set-primary-btn.active {
    background: var(--swedish-navy);
}

.delete-btn {
    background: #ef4444;
    color: white;
    border: none;
}

.file-upload-label {
    display: inline-block;
    padding: 0.5rem 1rem;
    background: var(--swedish-accent);
    color: var(--swedish-navy);
    border-radius: 0.5rem;
    cursor: pointer;
}

.file-upload-label input[type="file"] {
    display: none;
}

.help-text {
    font-size: 0.875rem;
    color: var(--swedish-text);
    opacity: 0.8;
    margin-top: 0.5rem;
}

.no-images-message {
    text-align: center;
    padding: 2rem;
    background: var(--swedish-gray);
    border-radius: 0.5rem;
    color: var(--swedish-text);
    font-style: italic;
}

/* Ensure form container matches your existing styles */
.form-container {
    background: var(--swedish-white);
    border-radius: 0.75rem;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    margin: 1rem 0;
    padding: 1.5rem;
}

.admin-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1.5rem;
}

.close-button {
    background: none;
    border: none;
    font-size: 1.5rem;
    color: var(--swedish-text);
    cursor: pointer;
    padding: 0.5rem;
}

.close-button:hover {
    color: var(--swedish-navy);
}
</style>
