{% extends "base.html" %}
{% block title %}Data-Driven Real Estate Agency{% endblock %}
{% block head %}
{{ super() }}
{% endblock %}
{% block content %}
<div id="content">
    <section class="hero-section">
        <div class="container">
            <h1 class="section-title">Welcome to Cherokee Street Real Estate: a Data Driven Real Estate Agency</h1>
            <p class="agency-intro">
                At Cherokee Street Real Estate, we harness the power of data to revolutionize your property journey. Our small team of dedicated, tech-savvy agents is committed to delivering exceptional results.
            </p>
        </div>
    </section>
    

    <h2 class="section-title">Featured Listings</h2>
    <div id="search-container">
    <!-- Add search input -->
    <p>
    Search By Name
    </p>
    <div class="search-controls-container">
        <input type="text" name="search" placeholder="Search properties by name..." 
               hx-post="/search"
               hx-trigger="keyup changed delay:500ms"
               hx-target="#listings-container"
               hx-indicator=".htmx-indicator"
               hx-swap="outerHTML">
        <div class="htmx-indicator">Searching...</div>
        <button hx-post="/randomize" hx-target="#listings-container" hx-swap="outerHTML" class="button">Randomize</button>
    </div>
    </div>
    <div id="listings-container" class="gridContainer">
        {% for listing in listings %}
        <div class="listing" hx-get="/property/{{ listing.id }}" hx-trigger="click" hx-target="#content" hx-push-url="true">
            <div class="listing-image">
                <img src="{{ listing.image_url }}" alt="{{ listing.title }}">
            </div>
            <div class="listing-info">
                <h2>{{ listing.title }}</h2>
                <p class="price">${{ "{:,.2f}".format(listing.price) }}</p>
                <p class="details">{{ listing.bedrooms }} bd | {{ listing.bathrooms }} ba | {{ listing.square_feet }} sqft</p>
                <p class="address">{{ listing.address }}</p>
            </div>
        </div>
        {% endfor %}
    </div>

    <section class="agency-description">
        <div class="container">
            <div class="agency-features">
                <div class="feature">
                    <h3>Market Predictions</h3>
                    <p>Our predictive models help you make informed decisions about when to buy or sell.</p>
                </div>
            </div>
            <a href="/about" class="learn-more-button">Learn More About Our Approach</a>
        </div>
    </section>
</div>
<script>
  function applyCropsAndLayout() {
    const listings = document.querySelectorAll('.listing');
    const cropTypes = ['portrait', 'landscape', 'square'];
    listings.forEach(listing => {
        const randomCrop = cropTypes[Math.floor(Math.random() * cropTypes.length)];
        listing.classList.remove('portrait', 'landscape', 'square');
        listing.classList.add(randomCrop);
    });
  }
  applyCropsAndLayout();
  document.body.addEventListener('htmx:afterSwap', function(event) {
    applyCropsAndLayout();
  });
</script>
{% endblock %}
